# ‚úÖ Environment Variables Migration - COMPLETED

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

–£—Å–ø–µ—à–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–ª–∏ —Å 3 —Ä–∞–∑–Ω—ã—Ö .env —Ñ–∞–π–ª–æ–≤ –Ω–∞ **–æ–¥–∏–Ω –º–∞—Å—Ç–µ—Ä-—Ñ–∞–π–ª**.

### ‚ùå –ë—ã–ª–æ (3 —Ñ–∞–π–ª–∞):
```
/.env              ‚Üí –¥–ª—è docker-compose
/backend/.env      ‚Üí –¥–ª—è Python app
/frontend/.env     ‚Üí –¥–ª—è Vite
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –î—É–±–ª–∏–∫–∞—Ç—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å —Ä–∞–∑–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- **TELEGRAM_BOT_TOKEN –±—ã–ª —Ä–∞–∑–Ω—ã–π –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö!**
- YOOKASSA –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞–ª–∏
- –°–ª–æ–∂–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å

### ‚úÖ –°—Ç–∞–ª–æ (1 –º–∞—Å—Ç–µ—Ä-—Ñ–∞–π–ª + 1 dev-—Ñ–∞–π–ª):
```
/.env              ‚Üí –ú–ê–°–¢–ï–†-–§–ê–ô–õ —Å–æ –≤—Å–µ–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
/frontend/.env     ‚Üí –¢–æ–ª—å–∫–æ VITE_* –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```

## üì¶ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –£–¥–∞–ª–µ–Ω—ã:
- ‚ùå `backend/.env` - –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω
- ‚ùå `backend/.env.example` - –ø–µ—Ä–µ–Ω–µ—Å—ë–Ω –≤ –∫–æ—Ä–µ–Ω—å

### –°–æ–∑–¥–∞–Ω—ã/–û–±–Ω–æ–≤–ª–µ–Ω—ã:
- ‚úÖ `/.env` - –Ω–æ–≤—ã–π –º–∞—Å—Ç–µ—Ä-—Ñ–∞–π–ª —Å–æ –í–°–ï–ú–ò –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
- ‚úÖ `/.env.example` - –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω
- ‚úÖ `/frontend/.env` - —É–ø—Ä–æ—â—ë–Ω (—Ç–æ–ª—å–∫–æ VITE_*)
- ‚úÖ `/frontend/.env.example` - –æ–±–Ω–æ–≤–ª—ë–Ω
- ‚úÖ `backend/app/config.py` - —Ç–µ–ø–µ—Ä—å —á–∏—Ç–∞–µ—Ç –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–≥–æ .env
- ‚úÖ `ENV.md` - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ `CLAUDE.md` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ ENV.md

### –ë—ç–∫–∞–ø—ã (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π):
```
.env.backup/
‚îú‚îÄ‚îÄ .env.root.20260130_133020
‚îú‚îÄ‚îÄ .env.backend.20260130_133020
‚îî‚îÄ‚îÄ .env.frontend.20260130_133020
```

## ‚ú® –ö–ª—é—á–µ–≤—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. TELEGRAM_BOT_TOKEN
```diff
- –ö–æ—Ä–Ω–µ–≤–æ–π .env: 7519479389:...  (—Å—Ç–∞—Ä—ã–π)
+ –ö–æ—Ä–Ω–µ–≤–æ–π .env: 8417319353:...  (production –±–æ—Ç) ‚úÖ
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∫–æ—Ä–Ω–µ–≤–æ–π .env:
- ‚úÖ `SENTRY_DSN` - backend error tracking
- ‚úÖ `VITE_SENTRY_DSN` - frontend error tracking
- ‚úÖ `ADMIN_TELEGRAM_ID` - –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ `ENVIRONMENT` - dev/staging/production
- ‚úÖ –í—Å–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ backend/.env

### 3. Backend —Ç–µ–ø–µ—Ä—å —á–∏—Ç–∞–µ—Ç –∏–∑ –∫–æ—Ä–Ω—è:
```python
# backend/app/config.py
PROJECT_ROOT = Path(__file__).parent.parent.parent
ENV_FILE = PROJECT_ROOT / ".env"  # ‚Üê –ö–æ—Ä–Ω–µ–≤–æ–π .env
```

## üß™ –¢–µ—Å—Ç—ã

–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã:

```
‚úÖ Config loads from root .env
‚úÖ TELEGRAM_BOT_TOKEN correct (production bot)
‚úÖ SENTRY_DSN configured
‚úÖ YOOKASSA_SHOP_ID configured
‚úÖ DATABASE_URL configured
‚úÖ REDIS_URL configured
‚úÖ All checks passed!
```

## üöÄ –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

### 1. –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ:

```bash
make dev          # –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
make stop         # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
```

### 2. Production –¥–µ–ø–ª–æ–π

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (/opt/cronbox):**

1. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ—Ä–Ω–µ–≤–æ–π `.env` —Å production –∑–Ω–∞—á–µ–Ω–∏—è–º–∏:

```bash
ssh cronbox
cd /opt/cronbox

# –û–±–Ω–æ–≤–∏—Ç—å .env (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ vim/nano)
nano .env

# –í–∞–∂–Ω–æ: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:
ENVIRONMENT=production
SECRET_KEY=<—Å–∏–ª—å–Ω—ã–π-–∫–ª—é—á>
JWT_SECRET=<–¥—Ä—É–≥–æ–π-—Å–∏–ª—å–Ω—ã–π-–∫–ª—é—á>
POSTGRES_PASSWORD=<–Ω–∞–¥–µ–∂–Ω—ã–π-–ø–∞—Ä–æ–ª—å>
REDIS_PASSWORD=<–Ω–∞–¥–µ–∂–Ω—ã–π-–ø–∞—Ä–æ–ª—å>
TELEGRAM_BOT_TOKEN=8417319353:...  # production –±–æ—Ç
```

2. –î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ GitHub Actions (–∫–∞–∫ –æ–±—ã—á–Ω–æ):
```bash
# –í GitHub ‚Üí Actions ‚Üí Manual Deploy ‚Üí Run workflow
```

### 3. –ß—Ç–æ –ù–ï –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å

‚ùå **–ù–µ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ** `backend/.env` - –æ–Ω –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω!
‚ùå **–ù–µ –¥—É–±–ª–∏—Ä—É–π—Ç–µ** –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏
‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ** —Ç–æ–ª—å–∫–æ –∫–æ—Ä–Ω–µ–≤–æ–π `/.env`

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[ENV.md](./ENV.md)** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ environment –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º
- **[CLAUDE.md](./CLAUDE.md)** - –û–±–Ω–æ–≤–ª–µ–Ω–æ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
- **[SENTRY_QUICKSTART.md](./SENTRY_QUICKSTART.md)** - Sentry setup (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

### –î–ª—è –∫–æ–º–∞–Ω–¥—ã:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –∫–æ—Ä–Ω–µ–≤–æ–π .env**
   - –í—Å–µ backend –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ–ø–µ—Ä—å —Ç–∞–º
   - Frontend .env —Ç–æ–ª—å–∫–æ –¥–ª—è VITE_* –≤ dev

2. **–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:**
   ```bash
   # 1. –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–Ω–µ–≤–æ–π .env
   # 2. –î–æ–±–∞–≤–∏—Ç—å –≤ .env.example
   # 3. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –≤ backend - –¥–æ–±–∞–≤–∏—Ç—å –≤ config.py
   # 4. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –≤ docker - –¥–æ–±–∞–≤–∏—Ç—å –≤ docker-compose environment
   ```

3. **Git –Ω–µ –≤–∏–¥–∏—Ç .env —Ñ–∞–π–ª—ã** (–æ–Ω–∏ –≤ .gitignore)
   - –°–µ–∫—Ä–µ—Ç—ã –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ‚úÖ
   - –ù–∞ production –æ–±–Ω–æ–≤–ª—è–π—Ç–µ .env –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤—Ä—É—á–Ω—É—é

### –û—Ç–∫–∞—Ç (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å):

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞
cp .env.backup/.env.root.20260130_133020 .env
cp .env.backup/.env.backend.20260130_133020 backend/.env

# –û—Ç–∫–∞—Ç–∏—Ç—å config.py
git checkout backend/app/config.py
```

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ production

–ü–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –¥–µ–ø–ª–æ–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
cd /opt/cronbox

# 1. –ö–æ—Ä–Ω–µ–≤–æ–π .env —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
ls -la .env

# 2. –°–æ–¥–µ—Ä–∂–∏—Ç production –∑–Ω–∞—á–µ–Ω–∏—è
grep ENVIRONMENT .env  # –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å production
grep TELEGRAM_BOT_TOKEN .env  # –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 8417319353:...

# 3. backend/.env –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
ls backend/.env  # –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "No such file"

# 4. Git status —á–∏—Å—Ç—ã–π (–Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω .env –≤ git)
git status  # –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å .env –≤ Changes
```

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–û–¥–∏–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã** –¥–ª—è –≤—Å–µ—Ö environment –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
‚úÖ **–ù–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤** - –ª–µ–≥–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å
‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã** (Telegram, YooKassa)
‚úÖ **CI/CD –Ω–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç** - –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Ä–∞–Ω—å—à–µ
‚úÖ **–ë—ç–∫–∞–ø—ã —Å–æ–∑–¥–∞–Ω—ã** - –º–æ–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞** - –¥–ª—è –≤—Å–µ–π –∫–æ–º–∞–Ω–¥—ã

---

**–°–æ–∑–¥–∞–Ω–æ:** 2026-01-30
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–ï–ù–û
