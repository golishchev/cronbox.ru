# Как я сделал сервис мониторинга для разработчиков

## Завязка

Каждый разработчик хоть раз просыпался от сообщения: «У нас не работает сайт». Начинаешь разбираться - оказывается, бэкап не делался уже неделю, потому что cron-задача тихо упала и никто не заметил.

Или ещё лучше: клиент звонит в панике, что SSL-сертификат истёк. А ты точно помнишь, что вроде бы ставил напоминание... или нет?

За годы работы я видел эти ситуации десятки раз. И каждый раз думал: почему нет простого инструмента, который бы следил за всем этим?

## Ниша, которую никто не занял

В какой-то момент я понял, что на российском рынке просто нет нормального решения для мониторинга фоновых задач. Есть Zabbix и Prometheus - но это комбайны для инфраструктуры, их нужно разворачивать, настраивать, поддерживать. Для небольшой команды или фрилансера - это overkill.

Нужен был простой сервис:
- Создал монитор за минуту
- Добавил одну строчку curl в конец скрипта
- Получаешь алерт, если что-то пошло не так

## Что я решил сделать

Вместо того чтобы искать и адаптировать чужие решения, я решил сделать своё. За пару месяцев собрал MVP и назвал его **CronBox**.

Что умеет сервис:

**Heartbeat-мониторинг (Dead Man's Switch)**

Вы создаёте монитор, получаете уникальный URL и добавляете его вызов в конец любого скрипта:

```bash
# Ваш скрипт бэкапа
pg_dump mydb > backup.sql
# Пинг CronBox - «я отработал»
curl -fsS https://api.cronbox.ru/ping/abc123
```

Если пинг не приходит вовремя - вы получаете уведомление в Telegram, на почту или через webhook. Это как Dead Man's Switch: пока всё работает - тишина, сломалось - сразу знаете.

**SSL-мониторинг**

Указываете домен - сервис проверяет сертификат и предупреждает за 30, 14, 7 и 1 день до истечения. Больше никаких «ой, а сертификат-то истёк».

**ICMP и TCP мониторинг**

Ping для проверки доступности серверов, TCP для проверки открытости портов. Упал сервер базы данных - узнаете через минуту, а не когда клиенты начнут жаловаться.

**HTTP-автоматизация**

Cron-задачи в облаке. Не нужно держать свой сервер для отправки отчётов по расписанию или синхронизации данных между сервисами. Настроили расписание - работает.

**Цепочки задач**

Можно связать несколько HTTP-запросов в цепочку и передавать данные между шагами. Например: получить заказ из CRM → проверить оплату → отправить уведомление клиенту.

**Мониторы процессов**

Это расширенная версия heartbeat-мониторинга для длительных задач. Обычный heartbeat - это один сигнал «я отработал». Но что если бэкап занимает 2 часа? Как узнать, что он завис на середине?

Мониторы процессов используют два сигнала: START и END. Вы получаете два URL и оборачиваете ими свой скрипт:

```bash
# Сигнал START
curl -fsS https://api.cronbox.ru/ping/start/abc123/start

# Ваш долгий бэкап
pg_dump mydb | gzip > backup.sql.gz

# Сигнал END
curl -fsS https://api.cronbox.ru/ping/end/abc123/end
```

Сервис отслеживает:
- Запустился ли процесс вовремя (grace period на старт)
- Завершился ли он в отведённое время (таймаут на выполнение)
- Сколько времени занял каждый запуск

Если бэкап обычно занимает 30 минут, а сегодня прошло уже 2 часа - вы получите алерт. Это спасает от ситуаций, когда задача зависла и молча ест ресурсы сервера.

## Технические решения

Стек выбрал прагматичный:
- **Backend**: Python + FastAPI + SQLAlchemy
- **Очереди**: Redis + APScheduler
- **Frontend**: React + Vite + TailwindCSS

Отдельная история - биллинг. Интеграция с ЮKassa прошла без особых проблем: рекуррентные платежи, подписки, оплата по счёту для юрлиц. Это то, чего не хватает зарубежным сервисам для российских пользователей.

## Тарифы

Бесплатный тариф позволяет попробовать все возможности:
- 5 cron-задач
- 2 heartbeat-монитора и 2 SSL-монитора
- 1 монитор процессов и 1 цепочка задач
- Уведомления в Telegram и Email

Для серьёзной работы - Pro за 290 ₽/мес: 25 cron-задач, по 10 мониторов каждого типа, webhook-уведомления и автоматический retry при ошибках.

## Что дальше

Сейчас сервис в начале пути. Ищу первых пользователей, которые готовы попробовать и дать обратную связь.

Для читателей vc.ru - **бесплатный Pro-тариф на 3 месяца**. Пришлите мне вашу почту в Telegram после регистрации, и я активирую.

---

**Ссылки:**
- Сервис: [cronbox.ru](https://cronbox.ru)
- Панель управления: [cp.cronbox.ru](https://cp.cronbox.ru)
- Telegram: [@cronbox](https://t.me/cronbox)

---

*Буду рад вопросам и фидбеку в комментариях. Если у вас был опыт с подобными инструментами - расскажите, чего не хватает.*
